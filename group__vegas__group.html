<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>hep-mc: VEGAS Integrator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">hep-mc
   &#160;<span id="projectnumber">0.5</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Introduction</span></a></li>
      <li><a href="modules.html"><span>Topics</span></a></li>
      <li><a href="namespacehep.html"><span>API&#160;Listing</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">VEGAS Integrator</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The VEGAS Monte Carlo integration algorithm. </p>
<p>The VEGAS Monte Carlo integration algorithm divides the integration into several sub-integrations, called iterations, and uses the results to automatically construct a PDF that is then used to do importance sampling in order to reduce the error, e.g. compared to <a class="el" href="group__plain__group.html#ga177da9c7fac0304c40d182ceb6008359">plain</a>.</p>
<p>The VEGAS algorithm is available in two forms:</p>
<ul>
<li><a class="el" href="group__vegas__group.html#gaada59d2b99e014be6f362f384da25483">vegas</a>, the single process interface and</li>
<li><a class="el" href="group__vegas__group.html#gaaa3d4ec505e3a7f3f6350c3b87f8fb36">mpi_vegas</a> which uses the Message Passing Interface (MPI) to distribute the calculation among parallel running processes. </li>
</ul>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaaa3d4ec505e3a7f3f6350c3b87f8fb36"><td class="memTemplParams" colspan="2">template&lt;typename T , typename I , typename R  = std::mt19937&gt; </td></tr>
<tr class="memitem:gaaa3d4ec505e3a7f3f6350c3b87f8fb36"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; vegas_result&lt; T &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__vegas__group.html#gaaa3d4ec505e3a7f3f6350c3b87f8fb36">hep::mpi_vegas</a> (MPI_Comm communicator, I &amp;&amp;integrand, std::vector&lt; std::size_t &gt; const &amp;iteration_calls, vegas_pdf&lt; T &gt; const &amp;start_pdf, T alpha=T(1.5), R &amp;&amp;generator=std::mt19937())</td></tr>
<tr class="separator:gaaa3d4ec505e3a7f3f6350c3b87f8fb36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae11545da136e5653cf9d2c556e8fb858"><td class="memTemplParams" colspan="2">template&lt;typename T , typename I , typename R  = std::mt19937&gt; </td></tr>
<tr class="memitem:gae11545da136e5653cf9d2c556e8fb858"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; vegas_result&lt; T &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__vegas__group.html#gae11545da136e5653cf9d2c556e8fb858">hep::mpi_vegas</a> (MPI_Comm communicator, I &amp;&amp;integrand, std::vector&lt; std::size_t &gt; const &amp;iteration_calls, std::size_t bins=128, T alpha=T(1.5), R &amp;&amp;generator=std::mt19937())</td></tr>
<tr class="separator:gae11545da136e5653cf9d2c556e8fb858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9304630a2d27587bcc2536bf1d6c5615"><td class="memTemplParams" colspan="2">template&lt;typename T , typename I , typename R &gt; </td></tr>
<tr class="memitem:ga9304630a2d27587bcc2536bf1d6c5615"><td class="memTemplItemLeft" align="right" valign="top">vegas_result&lt; T &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__vegas__group.html#ga9304630a2d27587bcc2536bf1d6c5615">hep::vegas_iteration</a> (I &amp;&amp;integrand, std::size_t calls, vegas_pdf&lt; T &gt; const &amp;pdf, R &amp;&amp;generator)</td></tr>
<tr class="separator:ga9304630a2d27587bcc2536bf1d6c5615"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaada59d2b99e014be6f362f384da25483"><td class="memTemplParams" colspan="2">template&lt;typename T , typename I , typename R  = std::mt19937&gt; </td></tr>
<tr class="memitem:gaada59d2b99e014be6f362f384da25483"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; vegas_result&lt; T &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__vegas__group.html#gaada59d2b99e014be6f362f384da25483">hep::vegas</a> (I &amp;&amp;integrand, std::vector&lt; std::size_t &gt; const &amp;iteration_calls, vegas_pdf&lt; T &gt; const &amp;start_pdf, T alpha=T(1.5), R &amp;&amp;generator=std::mt19937())</td></tr>
<tr class="separator:gaada59d2b99e014be6f362f384da25483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga984d8910b3a15ea986646027cf3ea7fb"><td class="memTemplParams" colspan="2">template&lt;typename T , typename I , typename R  = std::mt19937&gt; </td></tr>
<tr class="memitem:ga984d8910b3a15ea986646027cf3ea7fb"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; vegas_result&lt; T &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__vegas__group.html#ga984d8910b3a15ea986646027cf3ea7fb">hep::vegas</a> (I &amp;&amp;integrand, std::vector&lt; std::size_t &gt; const &amp;iteration_calls, std::size_t bins=128, T alpha=T(1.5), R &amp;&amp;generator=std::mt19937())</td></tr>
<tr class="separator:ga984d8910b3a15ea986646027cf3ea7fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaaa3d4ec505e3a7f3f6350c3b87f8fb36"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename I , typename R  = std::mt19937&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;vegas_result&lt;T&gt; &gt; hep::mpi_vegas </td>
          <td>(</td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>communicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">I &amp;&amp;&#160;</td>
          <td class="paramname"><em>integrand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::size_t &gt; const &amp;&#160;</td>
          <td class="paramname"><em>iteration_calls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vegas_pdf&lt; T &gt; const &amp;&#160;</td>
          <td class="paramname"><em>start_pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>T(1.5)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">R &amp;&amp;&#160;</td>
          <td class="paramname"><em>generator</em> = <code>std::mt19937()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Implements the MPI-parallelized VEGAS algorithm. This function can be used to start from an already adapted grid, e.g. one by <a class="el" href="classhep_1_1vegas__result.html#ad77c22b49fd6227a7070e23c64b8378b">vegas_result::pdf</a> obtained by a previous <a class="el" href="group__vegas__group.html#gaada59d2b99e014be6f362f384da25483">vegas</a> call. </p>

</div>
</div>
<a class="anchor" id="gae11545da136e5653cf9d2c556e8fb858"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename I , typename R  = std::mt19937&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;vegas_result&lt;T&gt; &gt; hep::mpi_vegas </td>
          <td>(</td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>communicator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">I &amp;&amp;&#160;</td>
          <td class="paramname"><em>integrand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::size_t &gt; const &amp;&#160;</td>
          <td class="paramname"><em>iteration_calls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>bins</em> = <code>128</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>T(1.5)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">R &amp;&amp;&#160;</td>
          <td class="paramname"><em>generator</em> = <code>std::mt19937()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Implements the MPI-parallelized VEGAS algorithm. See <a class="el" href="group__vegas__group.html#gaada59d2b99e014be6f362f384da25483">vegas</a> for a more detailed description on the VEGAS algorithm. In contrast to the single-threaded versions this function makes sure that every random number generator is seeded differently so every MPI process yields an independent result. After each iteration the intermediate results are passed to the function set by <a class="el" href="group__callbacks.html#gadb47eb6529daa5ddf5805612f4045c72">mpi_vegas_callback</a> which can e.g. be used to print them out. The callback function is able to stop the integration if it returns <code>false</code>. In this case less iterations are performed than requested. </p>

</div>
</div>
<a class="anchor" id="gaada59d2b99e014be6f362f384da25483"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename I , typename R  = std::mt19937&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;vegas_result&lt;T&gt; &gt; hep::vegas </td>
          <td>(</td>
          <td class="paramtype">I &amp;&amp;&#160;</td>
          <td class="paramname"><em>integrand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::size_t &gt; const &amp;&#160;</td>
          <td class="paramname"><em>iteration_calls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vegas_pdf&lt; T &gt; const &amp;&#160;</td>
          <td class="paramname"><em>start_pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>T(1.5)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">R &amp;&amp;&#160;</td>
          <td class="paramname"><em>generator</em> = <code>std::mt19937()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Integrates <code>function</code> by performing <code>iteration_calls.size()</code> iterations of the VEGAS algorithm, with as many function calls for each iteration specified by the corresponding value in <code>iteration_calls</code>. The pdf refinement is done using <a class="el" href="group__vegas__pdf__group.html#ga61cf454ae1f35640c315a8f733fa6dbb">vegas_refine_pdf</a> which is called with the \( \alpha \)-parameter given by <code>alpha</code>.</p>
<p>This function can be used to start from an already adapted pdf, e.g. one by <a class="el" href="classhep_1_1vegas__result.html#ad77c22b49fd6227a7070e23c64b8378b">vegas_result::pdf</a> obtained by a previous <a class="el" href="group__vegas__group.html#gaada59d2b99e014be6f362f384da25483">vegas</a> call. </p>

</div>
</div>
<a class="anchor" id="ga984d8910b3a15ea986646027cf3ea7fb"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename I , typename R  = std::mt19937&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;vegas_result&lt;T&gt; &gt; hep::vegas </td>
          <td>(</td>
          <td class="paramtype">I &amp;&amp;&#160;</td>
          <td class="paramname"><em>integrand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::size_t &gt; const &amp;&#160;</td>
          <td class="paramname"><em>iteration_calls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>bins</em> = <code>128</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T&#160;</td>
          <td class="paramname"><em>alpha</em> = <code>T(1.5)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">R &amp;&amp;&#160;</td>
          <td class="paramname"><em>generator</em> = <code>std::mt19937()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Integrates <code>function</code> over the unit-hypercube with <code>dimensions</code> by performing <code>iteration_calls.size()</code> iterations of the VEGAS algorithm, with as many function calls for each iteration specified by the corresponding value in <code>iteration_calls</code>. The pdf that is sampled from has <code>bins</code> for each dimension as is refined <a class="el" href="group__vegas__pdf__group.html#ga61cf454ae1f35640c315a8f733fa6dbb">vegas_refine_pdf</a> using the \( \alpha \)-parameter given by <code>alpha</code>. </p>

</div>
</div>
<a class="anchor" id="ga9304630a2d27587bcc2536bf1d6c5615"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename I , typename R &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vegas_result&lt;T&gt; hep::vegas_iteration </td>
          <td>(</td>
          <td class="paramtype">I &amp;&amp;&#160;</td>
          <td class="paramname"><em>integrand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>calls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vegas_pdf&lt; T &gt; const &amp;&#160;</td>
          <td class="paramname"><em>pdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">R &amp;&amp;&#160;</td>
          <td class="paramname"><em>generator</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Performs one VEGAS iteration. This integrates <code>function</code> over the unit-hypercube using <code>calls</code> function evaluations with random numbers generated by <code>generator</code>. The generator is not seeded. The <code>pdf</code> is used to implement importance sampling; stratified sampling is not used. The dimension of the function is determined by <code>pdf.size()</code>.</p>
<p>The parameter <code>total_calls</code> determines the sample size \( N \) of the iteration <a class="el" href="group__vegas__group.html#ga9304630a2d27587bcc2536bf1d6c5615">vegas_iteration</a> performs and therefore usually has usually the same value as <code>calls</code>. If VEGAS is run in parallel, then this function will be called multiple times with a differently seeded generator and with <code>calls</code> parameters each smaller than <code>total_calls</code> but their sum being equal to <code>total_calls</code>. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<hr class="footer"/>
</body>
</html>
